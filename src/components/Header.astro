---
import { Image } from "astro:assets";
import {
  Menu,
  X,
  ChevronDown,
  GraduationCap,
  Users,
  Calendar,
  BookOpen,
  Home,
  Medal,
  Book,
  Images,
  Phone,
} from "lucide-astro";
import logo from "@assets/logo/LogoSMKN14.png";

const links = [
  {
    name: "Beranda",
    href: "/",
    icon: Home,
    hasDropdown: false,
  },
  {
    name: "Tentang Kami",
    href: "/tentang",
    icon: Users,
    hasDropdown: false,
    dropdown: [
      { name: "Sejarah Sekolah", href: "/tentang/sejarah" },
      { name: "Visi & Misi", href: "/tentang/visi-misi" },
      { name: "Struktur Organisasi", href: "/tentang/struktur" },
    ],
  },
  {
    name: "Penerimaan",
    href: "/penerimaan",
    icon: GraduationCap,
    hasDropdown: false,
  },
  {
    name: "Akademik",
    href: "/akademik",
    icon: BookOpen,
    hasDropdown: false,
    dropdown: [
      { name: "Program Keahlian", href: "/akademik/program" },
      { name: "Kurikulum", href: "/akademik/kurikulum" },
      { name: "Jadwal Pelajaran", href: "/akademik/jadwal" },
    ],
  },
  {
    name: "Berita & Acara",
    href: "/berita",
    icon: Calendar,
    hasDropdown: false,
  },
  {
    name: "Staf & Guru",
    href: "/staf",
    icon: Medal,
    hasDropdown: false,
  },
  {
    name: "Kehidupan Siswa",
    href: "/kegiatan-siswa",
    icon: Book,
    hasDropdown: false,
  },
  {
    name: "Galeri",
    href: "/galeri",
    icon: Images,
    hasDropdown: false,
  },
  {
    name: "Kontak",
    href: "/kontak",
    icon: Phone,
    hasDropdown: false,
  },
];
---

<header class="bg-gradient-to-r from-primary via-primary-dark to-primary shadow-lg sticky top-0 z-50 backdrop-blur-md border-b border-white/10">
  <div class="container mx-auto px-4">
    <div class="flex items-center justify-between py-4">
      <!-- Logo Section -->
      <div class="flex items-center group">
        <a href="/" class="flex items-center transform transition-all duration-300 hover:scale-105">
          <div class="relative">
            <div class="absolute inset-0 bg-white/20 rounded-full blur-xl group-hover:bg-white/30 transition-all duration-300"></div>
            <Image
              src={logo}
              alt="Logo SMKN 14 Jakarta"
              width={56}
              height={56}
              format="webp"
              quality={90}
              class="h-14 w-auto relative z-10 drop-shadow-lg"
            />
          </div>
          <div class="ml-4">
            <span class="text-2xl font-bold text-white tracking-tight">SMKN 14</span>
            <div class="text-sm text-blue-100 font-medium tracking-wide">Jakarta</div>
          </div>
        </a>
      </div>

      <!-- Desktop Navigation -->
      <nav class="hidden lg:flex items-center space-x-1">
        {links.map((link) => (
          <div class="relative group">
            <a
              href={link.href}
              class:list={[
                "flex items-center px-4 py-2 rounded-lg text-white font-medium transition-all duration-300 hover:bg-white/10 hover:backdrop-blur-sm hover:shadow-lg hover:-translate-y-0.5",
                {
                  "bg-white/20 backdrop-blur-sm shadow-lg border border-white/20":
                    Astro.url.pathname === link.href,
                },
              ]}
            >
              {link.icon && <link.icon class="w-4 h-4 mr-2 opacity-80" />}
              <span class="whitespace-nowrap">{link.name}</span>
              {link.hasDropdown && (
                <ChevronDown class="w-4 h-4 ml-1 transform group-hover:rotate-180 transition-transform duration-300" />
              )}
            </a>

            <!-- Desktop Dropdown Menu -->
            {link.hasDropdown && link.dropdown && (
              <div class="absolute top-full left-0 mt-2 w-64 bg-white/95 backdrop-blur-md rounded-xl shadow-2xl border border-white/20 opacity-0 invisible group-hover:opacity-100 group-hover:visible transform translate-y-2 group-hover:translate-y-0 transition-all duration-300 pointer-events-none group-hover:pointer-events-auto">
                <div class="py-3">
                  {link.dropdown.map((dropdownItem) => (
                    <a
                      href={dropdownItem.href}
                      class="block px-6 py-3 text-gray-700 hover:text-primary hover:bg-primary/5 transition-all duration-200 border-l-4 border-transparent hover:border-primary"
                    >
                      {dropdownItem.name}
                    </a>
                  ))}
                </div>
              </div>
            )}
          </div>
        ))}
      </nav>

      <!-- Mobile Menu Toggle -->
      <div class="lg:hidden">
        <input type="checkbox" id="mobile-menu-toggle" class="peer hidden" />
        <label
          for="mobile-menu-toggle"
          class="relative p-2 text-white hover:bg-white/10 rounded-lg cursor-pointer transition-all duration-300 block"
        >
          <!-- Menu Icon -->
          <Menu class="h-6 w-6 transition-all duration-300" />
          <!-- Close Icon -->
          <X class="h-6 w-6 absolute top-2 left-2 transition-all duration-300 opacity-0 -rotate-90 scale-0" />
        </label>
      </div>
    </div>
  </div>

  <!-- Mobile Menu -->
  <div class="lg:hidden bg-white/95 backdrop-blur-xl border-t border-white/20 shadow-2xl max-h-0 overflow-hidden transition-all duration-500 ease-out peer-checked:max-h-screen">
    <!-- Mobile Search -->
    <div class="p-4 border-b border-gray-200 opacity-0 translate-y-4 transition-all duration-300 delay-100 peer-checked:opacity-100 peer-checked:translate-y-0">
      <div class="relative">
        <input
          type="text"
          placeholder="Cari informasi..."
          class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent transition-all duration-200"
        />
        <svg
          class="w-5 h-5 text-gray-400 absolute left-3 top-1/2 transform -translate-y-1/2"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
          ></path>
        </svg>
      </div>
    </div>

    <!-- Mobile Navigation -->
    <nav class="px-4 py-6 space-y-2">
      {links.map((link, index) => (
        <div class="opacity-0 translate-y-4 transition-all duration-300 peer-checked:opacity-100 peer-checked:translate-y-0" style={`transition-delay: ${(index + 2) * 50}ms`}>
          <div class="group">
            <a
              href={link.href}
              class:list={[
                "flex items-center px-4 py-3 rounded-xl text-gray-700 font-medium transition-all duration-300 hover:bg-primary/10 hover:text-primary hover:translate-x-2 group",
                {
                  "bg-primary/20 text-primary shadow-sm border-l-4 border-primary":
                    Astro.url.pathname === link.href,
                },
              ]}
            >
              {link.icon && (
                <link.icon class="w-5 h-5 mr-3 opacity-70 group-hover:opacity-100 transition-opacity duration-300" />
              )}
              <span class="flex-1">{link.name}</span>
              {link.hasDropdown && (
                <ChevronDown class="w-4 h-4 opacity-50 transform group-hover:rotate-180 transition-transform duration-300" />
              )}
            </a>

            <!-- Mobile Dropdown -->
            {link.hasDropdown && link.dropdown && (
              <div class="ml-8 mt-2 space-y-1 max-h-0 overflow-hidden group-hover:max-h-96 transition-all duration-300">
                {link.dropdown.map((dropdownItem, dropdownIndex) => (
                  <a
                    href={dropdownItem.href}
                    class="block px-4 py-2 text-sm text-gray-600 hover:text-primary hover:bg-primary/5 rounded-lg transition-all duration-200 opacity-0 translate-x-4 group-hover:opacity-100 group-hover:translate-x-0"
                    style={`transition-delay: ${dropdownIndex * 50}ms`}
                  >
                    {dropdownItem.name}
                  </a>
                ))}
              </div>
            )}
          </div>
        </div>
      ))}
    </nav>

    <!-- Mobile Contact Info -->
    <div class="px-4 py-6 border-t border-gray-200 bg-gray-50/80 opacity-0 translate-y-4 transition-all duration-300 delay-500 peer-checked:opacity-100 peer-checked:translate-y-0">
      <div class="space-y-3 text-sm text-gray-600">
        <div class="flex items-center transform hover:translate-x-1 transition-transform duration-200">
          <span class="mr-2">üìß</span>
          <span>info@smkn14jakarta.sch.id</span>
        </div>
        <div class="flex items-center transform hover:translate-x-1 transition-transform duration-200">
          <span class="mr-2">üìû</span>
          <span>(021) 123-4567</span>
        </div>
        <div class="flex items-center transform hover:translate-x-1 transition-transform duration-200">
          <span class="mr-2">üìç</span>
          <span>Jakarta Selatan</span>
        </div>
      </div>
    </div>
  </div>
</header>

<style>
  /* Mobile menu toggle functionality */
  #mobile-menu-toggle:checked + label .h-6:first-child {
    opacity: 0;
    transform: rotate(90deg) scale(0);
  }
  
  #mobile-menu-toggle:checked + label .h-6:last-child {
    opacity: 1;
    transform: rotate(0deg) scale(1);
  }
  
  #mobile-menu-toggle:checked ~ div[class*="lg:hidden"]:not([class*="flex"]) {
    max-height: 100vh !important;
    overflow: visible !important;
  }
  
  /* Fade in animation for mobile menu items */
  @keyframes fade-in-up {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  
  .animate-fade-in-up {
    animation: fade-in-up 0.3s ease-out forwards;
    opacity: 0;
  }

  /* Smooth scrolling */
  html {
    scroll-behavior: smooth;
  }

  /* Custom scrollbar */
  ::-webkit-scrollbar {
    width: 4px;
  }

  ::-webkit-scrollbar-track {
    background: transparent;
  }

  ::-webkit-scrollbar-thumb {
    background: rgba(99, 102, 241, 0.3);
    border-radius: 2px;
  }

  ::-webkit-scrollbar-thumb:hover {
    background: rgba(99, 102, 241, 0.5);
  }

  /* Enhanced hover effects for better UX */
  @media (hover: hover) {
    .group:hover .group-hover\:max-h-96 {
      max-height: 24rem;
    }
  }

  /* Add subtle animation to icons */
  .group:hover svg {
    transform: scale(1.1);
  }

  /* Better focus states for accessibility */
  input[type="checkbox"]:focus + label,
  input[type="text"]:focus,
  a:focus {
    outline: 2px solid rgba(99, 102, 241, 0.5);
    outline-offset: 2px;
  }
</style>